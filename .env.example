# ===================================
# Server Configuration
# ===================================
PORT=3001
NODE_ENV=development  # development | production

# ===================================
# Database Configuration
# ===================================
# MongoDB Atlas connection string
# Get it from: https://cloud.mongodb.com
# Format: mongodb+srv://username:password@cluster.mongodb.net/dbname
MONGODB_URI=mongodb+srv://username:password@cluster.mongodb.net/multi-agents?retryWrites=true&w=majority

# ===================================
# Claude Agent SDK
# ===================================
# Get your API key from: https://console.anthropic.com
# Minimum $5 credit required
ANTHROPIC_API_KEY=sk-ant-api03-YOUR_API_KEY_HERE

# ===================================
# GitHub OAuth
# ===================================
# Create OAuth App at: https://github.com/settings/developers
# Homepage URL: https://yourdomain.com
# Callback URL: https://yourdomain.com/api/auth/github/callback

GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret
GITHUB_CALLBACK_URL=http://localhost:3001/api/auth/github/callback

# ===================================
# Security Secrets
# ===================================
# Generate with: openssl rand -base64 32
# IMPORTANT: Use different secrets for each environment
# NEVER commit actual secrets to Git

JWT_SECRET=your_jwt_secret_minimum_32_characters_long_please
SESSION_SECRET=your_session_secret_minimum_32_characters_long_please

# ===================================
# Data Encryption (NEW)
# ===================================
# Encrypts sensitive data in MongoDB (API keys, tokens, passwords)
# Generate with: openssl rand -base64 32
# REQUIRED in production, optional in development (uses fallback)
# WARNING: If you change this key, encrypted data becomes unreadable!

ENV_ENCRYPTION_KEY=your_base64_encoded_32_byte_encryption_key

# ===================================
# CORS Configuration
# ===================================
# Frontend URL for CORS
# Development: http://localhost:3000
# Production: https://app.yourdomain.com

FRONTEND_URL=http://localhost:3000

# ===================================
# Agent Workspace
# ===================================
# Directory where agents clone and work on repositories
# Development: /tmp/agent-workspace
# Production: /var/www/multi-agents/workspaces

AGENT_WORKSPACE_DIR=/tmp/agent-workspace

# ===================================
# Optional: Advanced Configuration
# ===================================

# Scheduler Intervals (in minutes)
# WORKSPACE_CLEANUP_INTERVAL=60
# MERGE_COORDINATOR_INTERVAL=5

# Workspace Age Limit (in hours)
# MAX_WORKSPACE_AGE=24

# Rate Limiting
# RATE_LIMIT_WINDOW_MS=900000  # 15 minutes
# RATE_LIMIT_MAX_REQUESTS=100

# ===================================
# Orchestration Best Practices (NEW)
# ===================================

# Cost Budget Limits
MAX_TASK_COST_USD=10.0          # Maximum cost per task (default: $10)
MAX_PHASE_COST_USD=2.0           # Maximum cost per phase (default: $2)
COST_WARNING_THRESHOLD=0.8        # Warning threshold (0.8 = 80%)
ENABLE_COST_HARD_STOP=false      # Stop execution when budget exceeded

# Team Failure Circuit Breaker
TEAM_FAILURE_THRESHOLD=0.5       # Stop if >50% of teams fail

# Retry Configuration
MAX_RETRY_ATTEMPTS=3              # Maximum retry attempts for transient failures
RETRY_INITIAL_DELAY_MS=1000      # Initial retry delay (1 second)
RETRY_MAX_DELAY_MS=30000         # Maximum retry delay (30 seconds)

# Developer Loop Detection
DEVELOPER_MAX_ITERATIONS=100     # Maximum turns for developer
DEVELOPER_IDLE_THRESHOLD=80      # Turns without code changes before timeout
DEVELOPER_TIMEOUT_MS=1800000     # 30 minutes timeout

# Security
ENABLE_SECRETS_DETECTION=true    # Detect and sanitize secrets in outputs
ENABLE_INPUT_VALIDATION=true     # Validate agent outputs with schemas

# ===================================
# Development Only
# ===================================
# Set to 'true' to enable debug logging
# DEBUG=true

# Set to 'true' to disable authentication (NEVER in production!)
# DISABLE_AUTH=false
